{"ast":null,"code":"/**\n * @license\n * Copyright 2024 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nimport { Deferred } from './Deferred.js';\nimport { disposeSymbol } from './disposable.js';\n/**\n * @internal\n */\nexport class Mutex {\n  static Guard = class Guard {\n    #mutex;\n    constructor(mutex) {\n      this.#mutex = mutex;\n    }\n    [disposeSymbol]() {\n      return this.#mutex.release();\n    }\n  };\n  #locked = false;\n  #acquirers = [];\n  // This is FIFO.\n  async acquire() {\n    if (!this.#locked) {\n      this.#locked = true;\n      return new Mutex.Guard(this);\n    }\n    const deferred = Deferred.create();\n    this.#acquirers.push(deferred.resolve.bind(deferred));\n    await deferred.valueOrThrow();\n    return new Mutex.Guard(this);\n  }\n  release() {\n    const resolve = this.#acquirers.shift();\n    if (!resolve) {\n      this.#locked = false;\n      return;\n    }\n    resolve();\n  }\n}","map":{"version":3,"names":["Deferred","disposeSymbol","Mutex","Guard","mutex","constructor","release","locked","acquirers","acquire","deferred","create","push","resolve","bind","valueOrThrow","shift"],"sources":["/Users/jeffreyvanoosterwijk/Desktop/repos/resume-generator/node_modules/puppeteer-core/src/util/Mutex.ts"],"sourcesContent":["/**\n * @license\n * Copyright 2024 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nimport {Deferred} from './Deferred.js';\nimport {disposeSymbol} from './disposable.js';\n\n/**\n * @internal\n */\nexport class Mutex {\n  static Guard = class Guard {\n    #mutex: Mutex;\n    constructor(mutex: Mutex) {\n      this.#mutex = mutex;\n    }\n    [disposeSymbol](): void {\n      return this.#mutex.release();\n    }\n  };\n\n  #locked = false;\n  #acquirers: Array<() => void> = [];\n\n  // This is FIFO.\n  async acquire(): Promise<InstanceType<typeof Mutex.Guard>> {\n    if (!this.#locked) {\n      this.#locked = true;\n      return new Mutex.Guard(this);\n    }\n    const deferred = Deferred.create<void>();\n    this.#acquirers.push(deferred.resolve.bind(deferred));\n    await deferred.valueOrThrow();\n    return new Mutex.Guard(this);\n  }\n\n  release(): void {\n    const resolve = this.#acquirers.shift();\n    if (!resolve) {\n      this.#locked = false;\n      return;\n    }\n    resolve();\n  }\n}\n"],"mappings":"AAAA;;;;;AAKA,SAAQA,QAAQ,QAAO,eAAe;AACtC,SAAQC,aAAa,QAAO,iBAAiB;AAE7C;;;AAGA,OAAM,MAAOC,KAAK;EAChB,OAAOC,KAAK,GAAG,MAAMA,KAAK;IACxB,CAAAC,KAAM;IACNC,YAAYD,KAAY;MACtB,IAAI,CAAC,CAAAA,KAAM,GAAGA,KAAK;IACrB;IACA,CAACH,aAAa,IAAC;MACb,OAAO,IAAI,CAAC,CAAAG,KAAM,CAACE,OAAO,EAAE;IAC9B;GACD;EAED,CAAAC,MAAO,GAAG,KAAK;EACf,CAAAC,SAAU,GAAsB,EAAE;EAElC;EACA,MAAMC,OAAOA,CAAA;IACX,IAAI,CAAC,IAAI,CAAC,CAAAF,MAAO,EAAE;MACjB,IAAI,CAAC,CAAAA,MAAO,GAAG,IAAI;MACnB,OAAO,IAAIL,KAAK,CAACC,KAAK,CAAC,IAAI,CAAC;IAC9B;IACA,MAAMO,QAAQ,GAAGV,QAAQ,CAACW,MAAM,EAAQ;IACxC,IAAI,CAAC,CAAAH,SAAU,CAACI,IAAI,CAACF,QAAQ,CAACG,OAAO,CAACC,IAAI,CAACJ,QAAQ,CAAC,CAAC;IACrD,MAAMA,QAAQ,CAACK,YAAY,EAAE;IAC7B,OAAO,IAAIb,KAAK,CAACC,KAAK,CAAC,IAAI,CAAC;EAC9B;EAEAG,OAAOA,CAAA;IACL,MAAMO,OAAO,GAAG,IAAI,CAAC,CAAAL,SAAU,CAACQ,KAAK,EAAE;IACvC,IAAI,CAACH,OAAO,EAAE;MACZ,IAAI,CAAC,CAAAN,MAAO,GAAG,KAAK;MACpB;IACF;IACAM,OAAO,EAAE;EACX"},"metadata":{},"sourceType":"module","externalDependencies":[]}