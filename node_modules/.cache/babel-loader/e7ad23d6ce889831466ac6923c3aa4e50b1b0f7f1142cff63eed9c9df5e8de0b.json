{"ast":null,"code":"import React,{useEffect,useState}from'react';import Resume from'../resume/Resume';import{Editor,EditorState,ContentState,Modifier,getDefaultKeyBinding,CompositeDecorator}from'draft-js';import htmlToDraft from'html-to-draftjs';import'./App.css';import{htmlFile}from'./template';import puppeteer from'puppeteer';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const findWithRegex=(contentBlock,callback)=>{const text=contentBlock.getText();const regex=RegExp(/<[^>]+?>/g);let match;while((match=regex.exec(text))!==null){callback(match.index,match.index+match[0].length+1);}};const HighlightedHTMLTag=props=>{return/*#__PURE__*/_jsx(\"span\",{className:\"highlight\",children:props.children});};const decorator=new CompositeDecorator([{strategy:findWithRegex,component:HighlightedHTMLTag}]);export default function App(){const[html,setHtml]=useState('');const[editorState,setEditorState]=useState(EditorState.createWithContent(ContentState.createFromBlockArray(htmlToDraft(\"\").contentBlocks),decorator));useEffect(()=>{const html=htmlFile;const content=ContentState.createFromText(html);setEditorState(EditorState.push(editorState,content,'insert-characters'));setHtml(html.replaceAll('\\n',''));},[]);const handleChange=state=>{setEditorState(state);setHtml(state.getCurrentContent().getPlainText());};const handleKeyCommand=(command,editorState)=>{if(command==='split-block'){const selection=editorState.getSelection();const currentContent=editorState.getCurrentContent();const block=currentContent.getBlockForKey(selection.getStartKey()).getText();let howManySpaces=0;for(let i=0;i<block.length;i++){if(block[i]!==' '){howManySpaces=i;break;}}const newContentState=Modifier.replaceText(editorState.getCurrentContent(),editorState.getSelection(),'\\n'+' '.repeat(howManySpaces));setEditorState(EditorState.push(editorState,newContentState,'insert-characters'));return'handled';}if(command==='tab'){const newContentState=Modifier.replaceText(editorState.getCurrentContent(),editorState.getSelection(),'  '// Two spaces\n);setEditorState(EditorState.push(editorState,newContentState,'insert-characters'));return'handled';}if(command==='shift-tab'){const selection=editorState.getSelection();const currentContent=editorState.getCurrentContent();const block=currentContent.getBlockForKey(selection.getStartKey());const start=selection.getStartOffset();if(block.getText().slice(start-2,start)==='  '){const newContentState=Modifier.replaceText(currentContent,selection.merge({anchorOffset:start-2,focusOffset:start}),'');setEditorState(EditorState.push(editorState,newContentState,'delete-character'));}return'handled';}return'not-handled';};const keyBindingFn=event=>{if(event.key===\"Tab\"/* Tab */){return event.shiftKey?'shift-tab':'tab';}return getDefaultKeyBinding(event);};const createPdf=async()=>{const browser=await puppeteer.launch();const page=await browser.newPage();await page.setContent(html);await page.emulateMediaType('screen');const pdf=await page.pdf({format:'A4',printBackground:true});await browser.close();return pdf;};return/*#__PURE__*/_jsx(\"div\",{className:\"app\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"content\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:createPdf,children:\"Download PDF\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"myEditor\",children:/*#__PURE__*/_jsx(Editor,{editorState:editorState,handleKeyCommand:handleKeyCommand,onChange:handleChange,keyBindingFn:keyBindingFn})}),/*#__PURE__*/_jsx(Resume,{html:html})]})});}","map":{"version":3,"names":["React","useEffect","useState","Resume","Editor","EditorState","ContentState","Modifier","getDefaultKeyBinding","CompositeDecorator","htmlToDraft","htmlFile","puppeteer","jsx","_jsx","jsxs","_jsxs","findWithRegex","contentBlock","callback","text","getText","regex","RegExp","match","exec","index","length","HighlightedHTMLTag","props","className","children","decorator","strategy","component","App","html","setHtml","editorState","setEditorState","createWithContent","createFromBlockArray","contentBlocks","content","createFromText","push","replaceAll","handleChange","state","getCurrentContent","getPlainText","handleKeyCommand","command","selection","getSelection","currentContent","block","getBlockForKey","getStartKey","howManySpaces","i","newContentState","replaceText","repeat","start","getStartOffset","slice","merge","anchorOffset","focusOffset","keyBindingFn","event","key","shiftKey","createPdf","browser","launch","page","newPage","setContent","emulateMediaType","pdf","format","printBackground","close","onClick","onChange"],"sources":["/Users/jeffreyvanoosterwijk/Desktop/repos/resume-generator/src/components/App/App.tsx"],"sourcesContent":["import React, { useEffect, useState }  from 'react';\nimport Resume from '../resume/Resume';\nimport { Editor, EditorState, ContentState, Modifier, getDefaultKeyBinding, CompositeDecorator } from 'draft-js';\nimport htmlToDraft from 'html-to-draftjs';\nimport './App.css';\nimport { htmlFile } from './template';\nimport { ContentBlock } from 'draft-js';\nimport ReactDOMServer from 'react-dom/server';\nimport puppeteer from 'puppeteer';\n\nconst findWithRegex = (contentBlock: ContentBlock, callback: (begin: number, end: number) => void) => {\n  const text = contentBlock.getText();\n  const regex = RegExp(/<[^>]+?>/g);\n  let match: RegExpExecArray | null;\n  while ((match = regex.exec(text)) !== null) {\n    callback(match.index, match.index + match[0].length + 1);\n  }\n};\n\nconst HighlightedHTMLTag = (props: { children: any}) => {\n  return <span className=\"highlight\">{props.children}</span>;\n};\n\nconst decorator = new CompositeDecorator([\n  {\n    strategy: findWithRegex,\n    component: HighlightedHTMLTag\n  }\n]);\n\n\nexport default function App() {\n  const [html, setHtml] = useState('');\n  const [editorState, setEditorState] = useState<EditorState>(\n    EditorState.createWithContent(\n      ContentState.createFromBlockArray(\n        htmlToDraft(\"\").contentBlocks\n      ),\n      decorator\n    )\n  );\n  \n  useEffect(() => {\n    const html = htmlFile;\n    const content: ContentState = ContentState.createFromText(html);\n    setEditorState(EditorState.push(editorState, content, 'insert-characters'));\n    setHtml(html.replaceAll('\\n', ''));\n  },[]);\n\n  const handleChange = (state: EditorState) => {\n    setEditorState(state);\n    setHtml(state.getCurrentContent().getPlainText());\n  };\n\n  \n  const handleKeyCommand = (command: string, editorState: EditorState) => {\n    if (command === 'split-block') {\n      const selection = editorState.getSelection();\n      const currentContent = editorState.getCurrentContent();\n      const block = currentContent.getBlockForKey(selection.getStartKey()).getText();\n      let howManySpaces: number = 0;\n      for(let i = 0; i < block.length; i++) {\n        if (block[i] !== ' ') {\n          howManySpaces = i;\n          break;\n        }\n      }\n      const newContentState = Modifier.replaceText(\n        editorState.getCurrentContent(),\n        editorState.getSelection(),\n        '\\n' + ' '.repeat(howManySpaces)\n      );\n      setEditorState(EditorState.push(editorState, newContentState, 'insert-characters'));\n      return 'handled';\n    }\n\n    if (command === 'tab') {\n      const newContentState = Modifier.replaceText(\n        editorState.getCurrentContent(),\n        editorState.getSelection(),\n        '  ' // Two spaces\n      );\n      setEditorState(EditorState.push(editorState, newContentState, 'insert-characters'));\n      return 'handled';\n    }\n    if (command === 'shift-tab') {\n      const selection = editorState.getSelection();\n      const currentContent = editorState.getCurrentContent();\n      const block = currentContent.getBlockForKey(selection.getStartKey());\n      const start = selection.getStartOffset();\n      if (block.getText().slice(start - 2, start) === '  ') {\n        const newContentState = Modifier.replaceText(\n          currentContent,\n          selection.merge({ anchorOffset: start - 2, focusOffset: start }),\n          ''\n        );\n        setEditorState(EditorState.push(editorState, newContentState, 'delete-character'));\n      }\n      return 'handled';\n    }\n    return 'not-handled';\n  };\n\n  const keyBindingFn = (event: React.KeyboardEvent<{}>) => {\n    if (event.key === \"Tab\" /* Tab */) {\n      return event.shiftKey ? 'shift-tab' : 'tab';\n    }\n    return getDefaultKeyBinding(event);\n  };\n\n\n  const createPdf = async () => {\n    const browser = await puppeteer.launch();\n    const page = await browser.newPage();\n  \n    await page.setContent(html);\n    await page.emulateMediaType('screen');\n    const pdf = await page.pdf({ format: 'A4', printBackground: true });\n  \n    await browser.close();\n    return pdf;\n  };\n\n  return (\n    <div className=\"app\">\n      <div className=\"content\">\n      <div>\n        <button onClick={createPdf}>Download PDF</button>\n      </div>\n        <div className='myEditor'>\n          <Editor\n            editorState={editorState}\n            handleKeyCommand={handleKeyCommand}\n            onChange={handleChange} \n            keyBindingFn={keyBindingFn}\n          />\n        </div>\n        <Resume html={html}/>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}